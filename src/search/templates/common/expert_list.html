{% extends "base.html" %}
{% load staticfiles %}
{% load i18n %}
{% block content %}

<style>


 ul {
  list-style-type: none;
  width: 700px;
}

 h3 {
  font: bold 20px/1.5 Helvetica, Verdana, sans-serif;
}

 li img {
  float: left;
  margin: 0 15px 0 0;
}

 li p {
  font: 1000 12px/1.5 Georgia, Times New Roman, serif;
}

 li {
  padding: 10px;
  overflow: auto;
}

 li:hover {
  background: #eee;
  cursor: pointer;
}
</style>

<div class="container">
  <h2>Invite Experts to a Project</h2>
  <form action="{% url 'expert-list' %}" method="GET">{% csrf_token %}
  <div class="row">
  <table>
      <tr>
        <td>
          <select name="industry">
            <option id="industryALL" value="ALL">All</option>
            <option id="industryMC" value="MC">Management Consulting</option>
            <option id="industryEN" value="EN">Energy</option>
            <option id="industryHI" value="HI">Health care and Life Sciences</option>
            <option id="industryBI" value="BI">BioPharma</option>
            <option id="industryED" value="ED">Education</option>
            <option id="industrySE" value="SE">Semiconductor</option>
            <option id="industrySW" value="SW">Software</option>
            <option id="industryMB" value="MB">Mobile Internet and Computing</option>
            <option id="industryDS" value="DS">Data and Storage</option>
            <option id="industryVR" value="VR">VR/AI/Robotics</option>
            <option id="industryIT" value="IT">Internet of Things</option>
            <option id="industryGB" value="GB">Gaming and Media</option>
            <option id="industryET" value="ET">Entertainment</option>
            <option id="industryTL" value="TL">Transport and Logistics</option>
            <option id="industryAU" value="AU">Automotive</option>
            <option id="industryCG" value="CG">Consumer Goods</option>
            <option id="industryOT" value="OT">Others</option>
          </select>
        </td>
        <td>
          <select name="expertise">
            <option id="expertiseALL" value="ALL">All</option>
            <option id="expertiseST" value="ST">Strategy</option>
            <option id="expertiseBD" value="BD">Business Development and Sales</option>
            <option id="expertiseSP" value="SP">Strategic Partnership</option>
            <option id="expertiseMK" value="MK">Marketing</option>
            <option id="expertiseMT" value="MT">Market Research</option>
            <option id="expertiseOS" value="OS">Operations and Supply Chain</option>
            <option id="expertiseMA" value="MA">Merger and Acquisition</option>
            <option id="expertiseDA" value="DA">Data Analytics</option>
            <option id="expertiseSE" value="SE">Software Engineering</option>
            <option id="expertisePJ" value="PJ">Project Management</option>
            <option id="expertisePD" value="PD">Product Design and Development</option>
            <option id="expertisePM" value="PM">Product Management</option>
            <option id="expertiseEN" value="EN">Entrepreneurship</option>
            <option id="expertiseCS" value="CS">Corporate Strategy</option>
            <option id="expertiseCC" value="CC">Cloud Computing</option>
            <option id="expertiseAD" value="AD">Advertisement</option>
            <option id="expertiseCL" value="CL">Corporate Law</option>
            <option id="expertiseCF" value="CF">Corporate Finance</option>
            <option id="expertiseAT" value="AT">Accounting and Taxation</option>
            <option id="expertiseOT" value="OT">Others</option>
          </select>
        </td>
        <td>
          <select name="experience">
            <option id="experienceALL" value="ALL">All</option>
            <option id="experienceA" value="A">1-5 years</option>
            <option id="experienceB" value="B">5-10 years</option>
            <option id="experienceC" value="C">10-15 years</option>
            <option id="experienceC" value="D"> >15 years</option>
          </select>
        </td>
        <td>
          <select name="area">
            <option id="areaALL" value="ALL">All</option>
            <option id="areaBJ" value="BJ">Beijing</option>
            <option id="areaSF" value="SF">San Francisco</option>
            <option id="areaSN" value="SN">Singapore</option>
          </select>
        </td>
<!--       </tr>

    <tr> -->
      <td><button class="pure-button pure-button-primary" type="submit" value="Submit" > Submit </button>
      </td>
    </tr>
  <table>

  <script>
  function getQueryVariable(variable)
  {
         var query = window.location.search.substring(1);
         var vars = query.split("&");
         for (var i=0;i<vars.length;i++) {
                 var pair = vars[i].split("=");
                 if(pair[0] == variable){return pair[1];}
         }
         return(false);
  }

  function setSelectedIndex(s)
  {
    s.selected = true;
    return;
  }
  var strIndustryName = "industry";
  var strIndustryVal = getQueryVariable("industry");
  var strIndustryConcat = strIndustryName.concat(strIndustryVal);

  var strExpertiseName = "expertise";
  var strExpertiseVal = getQueryVariable("expertise");
  var strExpertiseConcat = strExpertiseName.concat(strExpertiseVal);

  var strExperienceName = "experience";
  var strExperienceVal = getQueryVariable("experience");
  var strExperienceConcat = strExperienceName.concat(strExperienceVal);

  var strAreaName = "area";
  var strAreaVal = getQueryVariable("area");
  var strAreaConcat = strAreaName.concat(strAreaVal);

  setSelectedIndex(document.getElementById(strIndustryConcat));
  setSelectedIndex(document.getElementById(strExpertiseConcat));
  setSelectedIndex(document.getElementById(strExperienceConcat));
  setSelectedIndex(document.getElementById(strAreaConcat));
  </script>

  <br>
  <br>
  {% if expert_list %}
    <div>
      <ul>
        {% for expert in expert_list %}
          <li>
            {% if expert.id in can_views %}
            <img src="/media/{{ expert.user.username }}.jpg" style="width:135px; height:144px" onerror="this.src='/static/images/empty_headshot.bmp';" />
            {% else %}
            <img src="/static/images/empty_headshot.bmp" style="width:135px; height:144px" onerror="this.src='/static/images/empty_headshot.bmp';" />
            {% endif %}

            <h3> <a href="/profile/{{ expert.user.username }}">{{ expert.user }}</a>
            </h3>
            <p>{{ expert.description_text}}</p>
            <p>{{ expert.email}}</p>
          </li>
        {% endfor %}
      </ul>
    </div>
      {% if is_paginated %}
          <div class="pagination" >
              <span class="page-links">
                  {% if page_obj.has_previous %}
                      <a id="prePage" href="?page={{ page_obj.previous_page_number }}">previous</a>
                      <script>
                       var prePage = document.getElementById("prePage");
                       var originalString = prePage.getAttribute("href");
                       if(getQueryVariable("industry") != false)
                       {
                         var concatStr = originalString.concat(
                           "&industry=",getQueryVariable("industry"),
                           "&expertise=",getQueryVariable("expertise"),
                           "&experience=",getQueryVariable("experience"),
                           "&area=",getQueryVariable("area"));
                         prePage.setAttribute("href", concatStr);
                       }
                      </script>
                  {% endif %}
                  <span class="page-current">
                      Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}.
                  </span>
                  {% if page_obj.has_next %}
                      <a id="nextPage" href="?page={{ page_obj.next_page_number }}">next</a>
                      <script>
                       var prePage = document.getElementById("nextPage");
                       var originalString = prePage.getAttribute("href");
                       if(getQueryVariable("industry") != false)
                       {
                         var concatStr = originalString.concat(
                           "&industry=",getQueryVariable("industry"),
                           "&expertise=",getQueryVariable("expertise"),
                           "&experience=",getQueryVariable("experience"),
                           "&area=",getQueryVariable("area"));
                         prePage.setAttribute("href", concatStr);
                       }
                      </script>
                  {% endif %}
              </span>
          </div>
      {% endif %}
  {% else %}
      <h3>Experts</h3>
      <p>No experts found in this area, please change search condition</p>
  {% endif %}

</div> <!-- for Container -->
{% endblock %}
